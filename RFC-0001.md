# RFC-0001 — Lux-Chain Protocol v1.0
**Status:** Draft  
**Date:** 2025-12-02  
**License:** MIT  

---

## 1. Abstract

This document specifies the **minimum technical requirements** for a Lux-Chain
compliant implementation. Lux-Chain defines a non-custodial, peer-to-peer
coordination protocol for value exchange, based on a finite state machine,
time-locked resolution, and minimal cryptographic proof.

This RFC does **not** define:

- tokens,
- fee models,
- chains or networks,
- identity systems,
- front-end applications.

It only defines the **core protocol behavior.**

---

## 2. Terminology

- **Party A** — initiator of the exchange.  
- **Party B** — counterparty of the exchange.  
- **Asset** — any transferable value (token, coin, IOU, document, right).  
- **Exchange** — a single logical interaction between Party A and Party B.  
- **Escrow/Lock** — a reversible commitment of value under clear conditions.  
- **Timeout / TimeLock** — maximum duration to reach agreement.  
- **Proof Object** — minimal record of a completed exchange.  

This RFC is intentionally chain-agnostic.

---

## 3. State Machine

A Lux-Chain exchange MUST follow this state machine:

```text
PENDING → LOCKED → (RELEASED | REFUNDED) → CLOSED
```

### 3.1 PENDING

An exchange is **PENDING** when:

- Terms have been proposed (amount, timeout, asset, chain, etc.).  
- No value has yet been locked in escrow.  

Transitions:

- `PENDING → LOCKED` (when the lock is confirmed).  
- `PENDING → CLOSED` is NOT allowed.  

### 3.2 LOCKED

An exchange is **LOCKED** when:

- Value has been committed under explicit conditions (e.g. HTLC, multisig, or
  equivalent escrow primitive).  
- Both parties can verify that funds are locked and recoverable (via RELEASE
  or REFUND).  

Transitions:

- `LOCKED → RELEASED` (mutual agreement before timeout).  
- `LOCKED → REFUNDED` (timeout reached or explicit cancellation logic).  

### 3.3 RELEASED

An exchange is **RELEASED** when:

- Both parties have agreed to finalize the transfer.  
- Funds are unlocked and delivered to the intended recipient(s).  

Transitions:

- `RELEASED → CLOSED` (proof object finalized).  

### 3.4 REFUNDED

An exchange is **REFUNDED** when:

- Timeout is exceeded, or  
- Clearly defined cancellation conditions are met, and  
- Funds are returned to their original owners.  

Transitions:

- `REFUNDED → CLOSED` (proof object finalized).  

### 3.5 CLOSED

An exchange is **CLOSED** when:

- The final state is **RELEASED** or **REFUNDED**, and  
- A **Proof Object** has been generated and stored.  

No further transitions are allowed from `CLOSED`.

---

## 4. TimeLock / Timeout

Each exchange MUST define a `timeout` value (seconds).

Recommended defaults (see LPIP-0003):

- 24h, 48h, 72h, or 7 days.

When the current time exceeds `start_time + timeout` and the exchange is still
`LOCKED`, the implementation MUST attempt a **REFUND** according to the rules
of the underlying chain and escrow mechanism.

---

## 5. Proof Object

Upon reaching `CLOSED`, an implementation MUST generate a **Proof Object**.

Suggested JSON schema:

```json
{
  "version": "1.0",
  "id": "lux-<timestamp>-<random>",
  "tx": "0xHASH",
  "state": "CLOSED",
  "result": "RELEASED or REFUNDED",
  "proof": "SHA256(...data)",
  "timestamp": 1700000000,
  "chain": "ANY",
  "meta": {}
}
```

### 5.1 Required fields

- `version` — protocol version string.  
- `id` — unique identifier for the exchange.  
- `state` — MUST be `CLOSED`.  
- `result` — MUST be `RELEASED` or `REFUNDED`.  
- `proof` — hash computed via SHA-256 (see LPIP-0002).  
- `timestamp` — UNIX timestamp at the moment of closure.  

### 5.2 Optional fields

- `tx` — transaction hash or reference in the underlying chain.  
- `chain` — identifier of the network used (e.g. `ETH`, `XRP`, `BTC-L2`).  
- `meta` — implementation-specific metadata (non-personal).  

NO personally identifiable information (PII) SHOULD be stored in the Proof Object.

---

## 6. Hash Function

Implementations MUST support **SHA-256** as the default hash function for
`proof` values, as defined in `LPIP-0002`.

Alternative or additional hash functions MAY be supported, but MUST NOT replace
SHA-256 as the minimum common denominator for interoperability.

---

## 7. Optional zk-Proofs

Implementations MAY support optional zero-knowledge proofs (zk-SNARKs, zk-STARKs,
or equivalent) as an additional field:

```json
{
  "zk": "ZKPROOF_BLOB_OR_REFERENCE"
}
```

This field is optional and MUST NOT be required to consider an implementation
Lux-Chain compliant.

---

## 8. Security Considerations

Lux-Chain does not provide custodial protection. Implementations MUST:

- Avoid introducing any form of shared custodial wallet.  
- Ensure that TimeLock and REFUND conditions are well tested.  
- Log and store Proof Objects securely.  
- Consider chain-specific reorg and finality behavior.  

Lux-Chain aims to **minimize** systemic risk by design, not to remove all risk.

---

## 9. Compliance

An implementation is considered **Lux-Chain compliant** if:

1. It respects the state machine defined in Section 3.  
2. It uses a TimeLock mechanism with REFUND behavior (Section 4).  
3. It generates a Proof Object with SHA-256 hash (Section 5 and 6).  
4. It does **not** introduce custody, required permissions, or fork restrictions
   (as stated in LPIP-0001).  

---

## 10. License

This RFC is released under the MIT License, allowing free use, modification,
and distribution, including forks, without restriction.

---
